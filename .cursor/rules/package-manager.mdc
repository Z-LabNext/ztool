---
description: 'åŒ…ç®¡ç†å™¨è§„èŒƒ - ä¼˜å…ˆä½¿ç”¨pnpm'
globs: package.json,pnpm-lock.yaml,*.lock
---

# åŒ…ç®¡ç†å™¨è§„èŒƒ

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

**é¡¹ç›®ç»Ÿä¸€ä½¿ç”¨pnpmä½œä¸ºåŒ…ç®¡ç†å™¨ï¼Œç¦æ­¢ä½¿ç”¨npmå’Œyarn**

## ğŸ“‹ åŒ…ç®¡ç†å™¨ä¼˜å…ˆçº§

1. **pnpm** (ä¼˜å…ˆ) - é«˜æ•ˆã€ä¸¥æ ¼ã€èŠ‚çœç©ºé—´
2. npm (å¤‡é€‰) - ä»…åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ä½¿ç”¨
3. yarn (ç¦æ­¢) - ä¸æ¨èä½¿ç”¨

## âœ… æ­£ç¡®çš„pnpmå‘½ä»¤

### ä¾èµ–ç®¡ç†

```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–
pnpm install

# æ·»åŠ ç”Ÿäº§ä¾èµ–
pnpm add <package-name>

# æ·»åŠ å¼€å‘ä¾èµ–
pnpm add -D <package-name>

# æ·»åŠ å…¨å±€ä¾èµ–
pnpm add -g <package-name>

# ç§»é™¤ä¾èµ–
pnpm remove <package-name>

# æ›´æ–°ä¾èµ–
pnpm update

# æ›´æ–°ç‰¹å®šä¾èµ–
pnpm update <package-name>
```

### è„šæœ¬æ‰§è¡Œ

```bash
# è¿è¡Œè„šæœ¬
pnpm run <script-name>

# è¿è¡Œæµ‹è¯•
pnpm test

# è¿è¡Œæ„å»º
pnpm run build

# è¿è¡Œå¼€å‘æœåŠ¡å™¨
pnpm run dev
```

### ç‰ˆæœ¬ç®¡ç†

```bash
# ç‰ˆæœ¬ç®¡ç†
pnpm version patch    # ä¿®è®¢ç‰ˆæœ¬ (1.0.0 -> 1.0.1)
pnpm version minor    # æ¬¡ç‰ˆæœ¬ (1.0.0 -> 1.1.0)
pnpm version major    # ä¸»ç‰ˆæœ¬ (1.0.0 -> 2.0.0)
```

### å‘å¸ƒç®¡ç†

```bash
# å‘å¸ƒåˆ°npm
pnpm publish

# å‘å¸ƒåˆ°ç‰¹å®šregistry
pnpm publish --registry <registry-url>
```

## âŒ ç¦æ­¢ä½¿ç”¨çš„å‘½ä»¤

### npmå‘½ä»¤ (ç¦æ­¢)

```bash
# âŒ ç¦æ­¢ä½¿ç”¨
npm install
npm add <package>
npm remove <package>
npm run <script>
npm version <type>
npm publish
```

### yarnå‘½ä»¤ (ç¦æ­¢)

```bash
# âŒ ç¦æ­¢ä½¿ç”¨
yarn install
yarn add <package>
yarn remove <package>
yarn run <script>
yarn version <type>
yarn publish
```

## ğŸ”§ é¡¹ç›®é…ç½®

### package.jsonè„šæœ¬

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "test": "vitest",
    "preview": "vite preview",
    "lint": "eslint src --ext .ts,.tsx",
    "format": "prettier --write src/**/*.{ts,tsx,js,jsx}"
  }
}
```

### pnpmé…ç½® (.npmrc)

```ini
# ä½¿ç”¨pnpmä½œä¸ºåŒ…ç®¡ç†å™¨
package-manager=pnpm

# ä¸¥æ ¼æ¨¡å¼
strict-peer-dependencies=false

# è‡ªåŠ¨å®‰è£…peerä¾èµ–
auto-install-peers=true

# ä½¿ç”¨ç¬¦å·é“¾æ¥
symlink=true
```

## ğŸš€ pnpmä¼˜åŠ¿

### 1. æ€§èƒ½ä¼˜åŠ¿

- **æ›´å¿«çš„å®‰è£…é€Ÿåº¦** - å¹¶è¡Œä¸‹è½½å’Œå®‰è£…
- **èŠ‚çœç£ç›˜ç©ºé—´** - å…¨å±€å­˜å‚¨ï¼Œé¿å…é‡å¤ä¸‹è½½
- **æ›´å¿«çš„CI/CD** - ç¼“å­˜æœºåˆ¶ä¼˜åŒ–

### 2. ä¸¥æ ¼æ€§ä¼˜åŠ¿

- **ä¸¥æ ¼çš„ä¾èµ–è§£æ** - é¿å…å¹½çµä¾èµ–
- **æ›´å¥½çš„å®‰å…¨æ€§** - é˜²æ­¢ä¾èµ–æ±¡æŸ“
- **æ›´æ¸…æ™°çš„ä¾èµ–æ ‘** - æ‰å¹³åŒ–ç»“æ„

### 3. å¼€å‘ä½“éªŒ

- **æ›´å¥½çš„é”™è¯¯ä¿¡æ¯** - æ¸…æ™°çš„é”™è¯¯æç¤º
- **æ›´å¿«çš„è„šæœ¬æ‰§è¡Œ** - ä¼˜åŒ–çš„è„šæœ¬è¿è¡Œ
- **æ›´å¥½çš„å·¥ä½œåŒºæ”¯æŒ** - monorepoå‹å¥½

## ğŸ“ æ–‡ä»¶ç»“æ„

### å¿…éœ€æ–‡ä»¶

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ package.json          # é¡¹ç›®é…ç½®
â”œâ”€â”€ pnpm-lock.yaml        # ä¾èµ–é”å®šæ–‡ä»¶
â””â”€â”€ .npmrc                # pnpmé…ç½® (å¯é€‰)
```

### å¿½ç•¥æ–‡ä»¶

```
# .gitignore ä¸­åº”åŒ…å«
node_modules/
.pnpm-store/
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ä¾èµ–å†²çª** - ä½¿ç”¨ `pnpm why <package>` æŸ¥çœ‹ä¾èµ–å…³ç³»
2. **ç¼“å­˜é—®é¢˜** - ä½¿ç”¨ `pnpm store prune` æ¸…ç†ç¼“å­˜
3. **æƒé™é—®é¢˜** - æ£€æŸ¥æ–‡ä»¶æƒé™å’Œç”¨æˆ·æƒé™

### è°ƒè¯•å‘½ä»¤

```bash
# æŸ¥çœ‹ä¾èµ–æ ‘
pnpm list

# æŸ¥çœ‹ç‰¹å®šåŒ…çš„ä¾èµ–
pnpm why <package-name>

# æŸ¥çœ‹è¿‡æ—¶çš„åŒ…
pnpm outdated

# æ¸…ç†ç¼“å­˜
pnpm store prune
```

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| ç‰¹æ€§     | pnpm       | npm    | yarn     |
| -------- | ---------- | ------ | -------- |
| å®‰è£…é€Ÿåº¦ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ |
| ç£ç›˜ä½¿ç”¨ | â­â­â­â­â­ | â­â­   | â­â­â­   |
| å®‰å…¨æ€§   | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ |
| ä¸¥æ ¼æ€§   | â­â­â­â­â­ | â­â­   | â­â­â­   |

## ğŸ¯ æœ€ä½³å®è·µ

### 1. ä¾èµ–ç®¡ç†

- ä½¿ç”¨ `pnpm add` è€Œä¸æ˜¯ `npm install`
- å®šæœŸè¿è¡Œ `pnpm update` æ›´æ–°ä¾èµ–
- ä½¿ç”¨ `pnpm audit` æ£€æŸ¥å®‰å…¨æ¼æ´

### 2. è„šæœ¬æ‰§è¡Œ

- æ‰€æœ‰è„šæœ¬é€šè¿‡ `pnpm run` æ‰§è¡Œ
- é¿å…ç›´æ¥ä½¿ç”¨ `npm run` æˆ– `yarn run`

### 3. ç‰ˆæœ¬æ§åˆ¶

- æäº¤ `pnpm-lock.yaml` åˆ°ç‰ˆæœ¬æ§åˆ¶
- ä¸è¦æäº¤ `node_modules/` ç›®å½•
- ä½¿ç”¨ `pnpm version` ç®¡ç†ç‰ˆæœ¬å·

### 4. å›¢é˜Ÿåä½œ

- ç¡®ä¿æ‰€æœ‰å›¢é˜Ÿæˆå‘˜ä½¿ç”¨pnpm
- åœ¨READMEä¸­è¯´æ˜åŒ…ç®¡ç†å™¨è¦æ±‚
- åœ¨CI/CDä¸­ä½¿ç”¨pnpmå‘½ä»¤

## âš ï¸ é‡è¦æé†’

1. **ç»Ÿä¸€æ€§** - æ•´ä¸ªé¡¹ç›®å¿…é¡»ä½¿ç”¨pnpm
2. **ä¸€è‡´æ€§** - æ‰€æœ‰è„šæœ¬å’Œå‘½ä»¤å¿…é¡»ä½¿ç”¨pnpm
3. **å…¼å®¹æ€§** - ç¡®ä¿pnpm-lock.yamlæ–‡ä»¶è¢«æ­£ç¡®ç®¡ç†
4. **æ€§èƒ½** - åˆ©ç”¨pnpmçš„æ€§èƒ½ä¼˜åŠ¿æå‡å¼€å‘æ•ˆç‡

---

**è®°ä½ï¼špnpmä¸æ˜¯å¯é€‰é¡¹ï¼Œæ˜¯å¿…éœ€é¡¹ï¼**
